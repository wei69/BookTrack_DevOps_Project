function cov_2d6o8tb95v(){var path="C:\\Users\\wei long\\Documents\\devoppart2\\BookTrack_DevOps_Project\\utils\\search-book-util.js";var hash="bc256bc4624b1968e11141989802e39e29118fbd";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\wei long\\Documents\\devoppart2\\BookTrack_DevOps_Project\\utils\\search-book-util.js",statementMap:{"0":{start:{line:2,column:13},end:{line:2,column:41}},"1":{start:{line:3,column:17},end:{line:3,column:36}},"2":{start:{line:6,column:18},end:{line:6,column:48}},"3":{start:{line:9,column:4},end:{line:11,column:5}},"4":{start:{line:10,column:8},end:{line:10,column:121}},"5":{start:{line:13,column:4},end:{line:15,column:5}},"6":{start:{line:14,column:8},end:{line:14,column:99}},"7":{start:{line:17,column:4},end:{line:33,column:5}},"8":{start:{line:19,column:30},end:{line:21,column:10}},"9":{start:{line:24,column:8},end:{line:26,column:9}},"10":{start:{line:25,column:12},end:{line:25,column:93}},"11":{start:{line:29,column:8},end:{line:29,column:44}},"12":{start:{line:31,column:8},end:{line:31,column:54}},"13":{start:{line:32,column:8},end:{line:32,column:112}},"14":{start:{line:38,column:4},end:{line:38,column:58}},"15":{start:{line:41,column:0},end:{line:41,column:33}}},fnMap:{"0":{name:"searchBooks",decl:{start:{line:5,column:15},end:{line:5,column:26}},loc:{start:{line:5,column:37},end:{line:34,column:1}},line:5},"1":{name:"escapeRegex",decl:{start:{line:37,column:9},end:{line:37,column:20}},loc:{start:{line:37,column:27},end:{line:39,column:1}},line:37}},branchMap:{"0":{loc:{start:{line:9,column:4},end:{line:11,column:5}},type:"if",locations:[{start:{line:9,column:4},end:{line:11,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:9},"1":{loc:{start:{line:9,column:8},end:{line:9,column:66}},type:"binary-expr",locations:[{start:{line:9,column:8},end:{line:9,column:14}},{start:{line:9,column:18},end:{line:9,column:43}},{start:{line:9,column:47},end:{line:9,column:66}}],line:9},"2":{loc:{start:{line:13,column:4},end:{line:15,column:5}},type:"if",locations:[{start:{line:13,column:4},end:{line:15,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:13},"3":{loc:{start:{line:24,column:8},end:{line:26,column:9}},type:"if",locations:[{start:{line:24,column:8},end:{line:26,column:9}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:24}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"bc256bc4624b1968e11141989802e39e29118fbd"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2d6o8tb95v=function(){return actualCoverage;};}return actualCoverage;}cov_2d6o8tb95v();// Import the Book model to interact with the database
const Book=(cov_2d6o8tb95v().s[0]++,require('../models/book.js'));const mongoose=(cov_2d6o8tb95v().s[1]++,require('mongoose'));// Import mongoose to validate object IDs
async function searchBooks(req,res){cov_2d6o8tb95v().f[0]++;const query=(cov_2d6o8tb95v().s[2]++,req.query.query?.toLowerCase());// Use optional chaining to safely access query
// Check if the query is provided and valid
cov_2d6o8tb95v().s[3]++;if((cov_2d6o8tb95v().b[1][0]++,!query)||(cov_2d6o8tb95v().b[1][1]++,typeof query!=='string')||(cov_2d6o8tb95v().b[1][2]++,query.trim()==='')){cov_2d6o8tb95v().b[0][0]++;cov_2d6o8tb95v().s[4]++;return res.status(400).json({error:'Invalid parameter: "query" is required and must be a non-empty string.'});}else{cov_2d6o8tb95v().b[0][1]++;}// Limit query length to 100 characters
cov_2d6o8tb95v().s[5]++;if(query.length>100){cov_2d6o8tb95v().b[2][0]++;cov_2d6o8tb95v().s[6]++;return res.status(400).json({error:'Query is too long. Max length is 100 characters.'});}else{cov_2d6o8tb95v().b[2][1]++;}cov_2d6o8tb95v().s[7]++;try{// Search for books that match the title 
const filteredBooks=(cov_2d6o8tb95v().s[8]++,await Book.find({title:{$regex:escapeRegex(query),$options:'i'}// Case-insensitive search with escaped query
}));// Check if any books are found
cov_2d6o8tb95v().s[9]++;if(filteredBooks.length===0){cov_2d6o8tb95v().b[3][0]++;cov_2d6o8tb95v().s[10]++;return res.status(404).json({message:'No books found matching your search.'});}else{cov_2d6o8tb95v().b[3][1]++;}// Return the filtered results
cov_2d6o8tb95v().s[11]++;res.status(200).json(filteredBooks);// Send 200 OK status with the results
}catch(error){cov_2d6o8tb95v().s[12]++;console.error('Error fetching books:',error);cov_2d6o8tb95v().s[13]++;res.status(500).json({message:'An error occurred while searching for books.',error:error.message});}}// Function to escape regex special characters
function escapeRegex(text){cov_2d6o8tb95v().f[1]++;cov_2d6o8tb95v().s[14]++;return text.replace(/[-\/\\^$.*+?()[\]{}|]/g,'\\$&');// Escape special characters
}cov_2d6o8tb95v().s[15]++;module.exports={searchBooks};// Export the searchBooks function to be used in index.js
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMmQ2bzh0Yjk1diIsImFjdHVhbENvdmVyYWdlIiwiQm9vayIsInMiLCJyZXF1aXJlIiwibW9uZ29vc2UiLCJzZWFyY2hCb29rcyIsInJlcSIsInJlcyIsImYiLCJxdWVyeSIsInRvTG93ZXJDYXNlIiwiYiIsInRyaW0iLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJsZW5ndGgiLCJmaWx0ZXJlZEJvb2tzIiwiZmluZCIsInRpdGxlIiwiJHJlZ2V4IiwiZXNjYXBlUmVnZXgiLCIkb3B0aW9ucyIsIm1lc3NhZ2UiLCJjb25zb2xlIiwidGV4dCIsInJlcGxhY2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsic2VhcmNoLWJvb2stdXRpbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJbXBvcnQgdGhlIEJvb2sgbW9kZWwgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgZGF0YWJhc2VcclxuY29uc3QgQm9vayA9IHJlcXVpcmUoJy4uL21vZGVscy9ib29rLmpzJyk7XHJcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsgLy8gSW1wb3J0IG1vbmdvb3NlIHRvIHZhbGlkYXRlIG9iamVjdCBJRHNcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHNlYXJjaEJvb2tzKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCBxdWVyeSA9IHJlcS5xdWVyeS5xdWVyeT8udG9Mb3dlckNhc2UoKTsgLy8gVXNlIG9wdGlvbmFsIGNoYWluaW5nIHRvIHNhZmVseSBhY2Nlc3MgcXVlcnlcclxuXHJcbiAgICAvLyBDaGVjayBpZiB0aGUgcXVlcnkgaXMgcHJvdmlkZWQgYW5kIHZhbGlkXHJcbiAgICBpZiAoIXF1ZXJ5IHx8IHR5cGVvZiBxdWVyeSAhPT0gJ3N0cmluZycgfHwgcXVlcnkudHJpbSgpID09PSAnJykge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCBwYXJhbWV0ZXI6IFwicXVlcnlcIiBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhIG5vbi1lbXB0eSBzdHJpbmcuJyB9KTtcclxuICAgIH1cclxuICAgIC8vIExpbWl0IHF1ZXJ5IGxlbmd0aCB0byAxMDAgY2hhcmFjdGVyc1xyXG4gICAgaWYgKHF1ZXJ5Lmxlbmd0aCA+IDEwMCkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnUXVlcnkgaXMgdG9vIGxvbmcuIE1heCBsZW5ndGggaXMgMTAwIGNoYXJhY3RlcnMuJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIFNlYXJjaCBmb3IgYm9va3MgdGhhdCBtYXRjaCB0aGUgdGl0bGUgXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRCb29rcyA9IGF3YWl0IEJvb2suZmluZCh7XHJcbiAgICAgICAgICAgIHRpdGxlOiB7ICRyZWdleDogZXNjYXBlUmVnZXgocXVlcnkpLCAkb3B0aW9uczogJ2knIH0gLy8gQ2FzZS1pbnNlbnNpdGl2ZSBzZWFyY2ggd2l0aCBlc2NhcGVkIHF1ZXJ5XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIGFueSBib29rcyBhcmUgZm91bmRcclxuICAgICAgICBpZiAoZmlsdGVyZWRCb29rcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgbWVzc2FnZTogJ05vIGJvb2tzIGZvdW5kIG1hdGNoaW5nIHlvdXIgc2VhcmNoLicgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSZXR1cm4gdGhlIGZpbHRlcmVkIHJlc3VsdHNcclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihmaWx0ZXJlZEJvb2tzKTsgLy8gU2VuZCAyMDAgT0sgc3RhdHVzIHdpdGggdGhlIHJlc3VsdHNcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYm9va3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHNlYXJjaGluZyBmb3IgYm9va3MuJywgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGVzY2FwZSByZWdleCBzcGVjaWFsIGNoYXJhY3RlcnNcclxuZnVuY3Rpb24gZXNjYXBlUmVnZXgodGV4dCkge1xyXG4gICAgcmV0dXJuIHRleHQucmVwbGFjZSgvWy1cXC9cXFxcXiQuKis/KClbXFxde318XS9nLCAnXFxcXCQmJyk7IC8vIEVzY2FwZSBzcGVjaWFsIGNoYXJhY3RlcnNcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7IHNlYXJjaEJvb2tzIH07IC8vIEV4cG9ydCB0aGUgc2VhcmNoQm9va3MgZnVuY3Rpb24gdG8gYmUgdXNlZCBpbiBpbmRleC5qcyJdLCJtYXBwaW5ncyI6IjQxRkFlWTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FmWjtBQUNBLEtBQU0sQ0FBQUUsSUFBSSxFQUFBRixjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLG1CQUFtQixDQUFDLEVBQ3pDLEtBQU0sQ0FBQUMsUUFBUSxFQUFBTCxjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO0FBRXRDLGNBQWUsQ0FBQUUsV0FBV0EsQ0FBQ0MsR0FBRyxDQUFFQyxHQUFHLENBQUUsQ0FBQVIsY0FBQSxHQUFBUyxDQUFBLE1BQ2pDLEtBQU0sQ0FBQUMsS0FBSyxFQUFBVixjQUFBLEdBQUFHLENBQUEsTUFBR0ksR0FBRyxDQUFDRyxLQUFLLENBQUNBLEtBQUssRUFBRUMsV0FBVyxDQUFDLENBQUMsRUFBRTtBQUU5QztBQUFBWCxjQUFBLEdBQUFHLENBQUEsTUFDQSxHQUFJLENBQUFILGNBQUEsR0FBQVksQ0FBQSxVQUFDRixLQUFLLElBQUFWLGNBQUEsR0FBQVksQ0FBQSxTQUFJLE1BQU8sQ0FBQUYsS0FBSyxHQUFLLFFBQVEsSUFBQVYsY0FBQSxHQUFBWSxDQUFBLFNBQUlGLEtBQUssQ0FBQ0csSUFBSSxDQUFDLENBQUMsR0FBSyxFQUFFLEVBQUUsQ0FBQWIsY0FBQSxHQUFBWSxDQUFBLFNBQUFaLGNBQUEsR0FBQUcsQ0FBQSxNQUM1RCxNQUFPLENBQUFLLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBRUMsS0FBSyxDQUFFLHdFQUF5RSxDQUFDLENBQUMsQ0FDcEgsQ0FBQyxLQUFBaEIsY0FBQSxHQUFBWSxDQUFBLFVBQ0Q7QUFBQVosY0FBQSxHQUFBRyxDQUFBLE1BQ0EsR0FBSU8sS0FBSyxDQUFDTyxNQUFNLENBQUcsR0FBRyxDQUFFLENBQUFqQixjQUFBLEdBQUFZLENBQUEsU0FBQVosY0FBQSxHQUFBRyxDQUFBLE1BQ3BCLE1BQU8sQ0FBQUssR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFFQyxLQUFLLENBQUUsa0RBQW1ELENBQUMsQ0FBQyxDQUM5RixDQUFDLEtBQUFoQixjQUFBLEdBQUFZLENBQUEsVUFBQVosY0FBQSxHQUFBRyxDQUFBLE1BRUQsR0FBSSxDQUNBO0FBQ0EsS0FBTSxDQUFBZSxhQUFhLEVBQUFsQixjQUFBLEdBQUFHLENBQUEsTUFBRyxLQUFNLENBQUFELElBQUksQ0FBQ2lCLElBQUksQ0FBQyxDQUNsQ0MsS0FBSyxDQUFFLENBQUVDLE1BQU0sQ0FBRUMsV0FBVyxDQUFDWixLQUFLLENBQUMsQ0FBRWEsUUFBUSxDQUFFLEdBQUksQ0FBRTtBQUN6RCxDQUFDLENBQUMsRUFFRjtBQUFBdkIsY0FBQSxHQUFBRyxDQUFBLE1BQ0EsR0FBSWUsYUFBYSxDQUFDRCxNQUFNLEdBQUssQ0FBQyxDQUFFLENBQUFqQixjQUFBLEdBQUFZLENBQUEsU0FBQVosY0FBQSxHQUFBRyxDQUFBLE9BQzVCLE1BQU8sQ0FBQUssR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFFUyxPQUFPLENBQUUsc0NBQXVDLENBQUMsQ0FBQyxDQUNwRixDQUFDLEtBQUF4QixjQUFBLEdBQUFZLENBQUEsVUFFRDtBQUFBWixjQUFBLEdBQUFHLENBQUEsT0FDQUssR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQ0csYUFBYSxDQUFDLENBQUU7QUFDekMsQ0FBRSxNQUFPRixLQUFLLENBQUUsQ0FBQWhCLGNBQUEsR0FBQUcsQ0FBQSxPQUNac0IsT0FBTyxDQUFDVCxLQUFLLENBQUMsdUJBQXVCLENBQUVBLEtBQUssQ0FBQyxDQUFDaEIsY0FBQSxHQUFBRyxDQUFBLE9BQzlDSyxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUVTLE9BQU8sQ0FBRSw4Q0FBOEMsQ0FBRVIsS0FBSyxDQUFFQSxLQUFLLENBQUNRLE9BQVEsQ0FBQyxDQUFDLENBQzNHLENBQ0osQ0FFQTtBQUNBLFFBQVMsQ0FBQUYsV0FBV0EsQ0FBQ0ksSUFBSSxDQUFFLENBQUExQixjQUFBLEdBQUFTLENBQUEsTUFBQVQsY0FBQSxHQUFBRyxDQUFBLE9BQ3ZCLE1BQU8sQ0FBQXVCLElBQUksQ0FBQ0MsT0FBTyxDQUFDLHdCQUF3QixDQUFFLE1BQU0sQ0FBQyxDQUFFO0FBQzNELENBQUMzQixjQUFBLEdBQUFHLENBQUEsT0FFRHlCLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHLENBQUV2QixXQUFZLENBQUMsQ0FBRSIsImlnbm9yZUxpc3QiOltdfQ==